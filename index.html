<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>3D Interactive Map with Birth Rate</title>
  <style>
    #map-container {
      width: 100vw;
      height: 100vh;
    }

    .legend {
      position: absolute;
      bottom: 20px;
      left: 20px;
      display: flex;
      flex-direction: column;
    }

    .legend-item {
      display: flex;
      align-items: center;
      margin-bottom: 5px;
    }

    .legend-color {
      width: 20px;
      height: 20px;
      margin-right: 5px;
    }
  </style>
</head>
<body>

<h1>3D Interactive Map with Birth Rate</h1>

<div id="map-container"></div>

<div class="legend">
  <div class="legend-item">
    <div class="legend-color" style="background-color: #ccc;"></div>
    <span>No Data</span>
  </div>
  <div class="legend-item">
    <div class="legend-color" style="background-color: #08519c;"></div>
    <span>Low Birth Rate</span>
  </div>
  <div class="legend-item">
    <div class="legend-color" style="background-color: #bdd7e7;"></div>
    <span>High Birth Rate</span>
  </div>
</div>

<script src="https://d3js.org/d3.v5.min.js"></script>
<script>

const width = window.innerWidth;
const height = window.innerHeight;

// Load data from CSV
d3.csv("Global_Education.csv").then((educationData) => {
  const projection = d3.geoOrthographic()
    .scale(200)
    .translate([width / 2, height / 2])
    .rotate([0, 0]);

  const path = d3.geoPath().projection(projection);

  const colorScale = d3.scaleSequential(d3.interpolateBlues)
    .domain([0, 10]);

  const svg = d3.select("#map-container").append("svg")
    .attr("width", "100%")
    .attr("height", "100%")
    .attr("viewBox", `0 0 ${width} ${height}`);

  // Load world map data
  d3.json("countries.geo.json").then((world) => {
    svg.selectAll("path")
      .data(world.features)
      .enter().append("path")
      .attr("class", "country")
      .attr("d", path)
      .attr("fill", (d) => {
        // Find corresponding data in the CSV using latitude and longitude
        const latitude = d.properties.Latitude; // Updated with capitalized "Latitude"
        const longitude = d.properties.Longitude; // Updated with capitalized "Longitude"

        const matchingData = educationData.find((data) => {
          return +data.Latitude === +latitude && +data.Longitude === +longitude;
        });

        // If matching data is found, use the birth rate for coloring
        if (matchingData) {
          const birthRate = +matchingData.Birth_Rate;
          return colorScale(birthRate);
        }

        // Default color if data is not found
        return "#ccc";
      })
      .on("mouseover", (event, d) => {
        // Add tooltip or additional interactions if needed
      });
  });
});

</script>

</body>
</html>

